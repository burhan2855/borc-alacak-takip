<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#7c3aed">
    <meta name="description" content="BorÃ§ ve alacaklarÄ±nÄ±zÄ± kolayca takip edin">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="BorÃ§ Takip">
    <title>BorÃ§ & Alacak Takip</title>
    
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkJvcsOnICYgQWxhY2FrIFRha2lwIiwKICAic2hvcnRfbmFtZSI6ICJCb3LDpyBUYWtpcCIsCiAgInN0YXJ0X3VybCI6ICIuLyIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzFmMjkzNyIsCiAgInRoZW1lX2NvbG9yIjogIiM3YzNhZWQiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSGRwWkhSb1BTSXhPVElpSUdobGFXZG9kRDBpTVRreUlqNDhjbVZqZENCM2FXUjBhRDBpTVRreUlpQm9aV2xuYUhROUlqRTVNaUlnWm1sc2JEMGlJemRqTTJGbFpDSXZQangwWlhoMElIZzlJalEwSWlCNVBTSTROQ0lnWm1sc2JEMGlkMmhwZEdVaUlHWnZiblF0YzJsNlpUMGlOREFpSUdadmJuUXRkMlZwWjJoMFBTSmliMnhrSWo0OFAzUjBlSFE4TDNOMlp6ND0iLAogICAgICAic2l6ZXMiOiAiMTkyeDE5MiIsCiAgICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9CiAgXQp9">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1e293b 0%, #7e22ce 50%, #1e293b 100%);
            min-height: 100vh;
            padding-bottom: 80px;
            overflow-x: hidden;
        }
        
        .header {
            position: sticky;
            top: 0;
            z-index: 50;
            background: linear-gradient(90deg, #7e22ce 0%, #4f46e5 100%);
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            padding: 16px;
        }
        
        .header-title {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .header-title h1 {
            color: white;
            font-size: 20px;
            font-weight: bold;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }
        
        .stat-card {
            border-radius: 12px;
            padding: 8px;
            text-align: center;
        }
        
        .stat-card.kasa { background: rgba(234, 179, 8, 0.9); }
        .stat-card.borc { background: rgba(239, 68, 68, 0.9); }
        .stat-card.alacak { background: rgba(34, 197, 94, 0.9); }
        .stat-card.net { background: linear-gradient(135deg, #a855f7 0%, #4f46e5 100%); }
        
        .stat-label {
            color: white;
            font-size: 11px;
            font-weight: 500;
            margin-bottom: 4px;
        }
        
        .stat-value {
            color: white;
            font-size: 13px;
            font-weight: bold;
        }
        
        .container {
            padding: 16px;
        }
        
        .button-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 16px;
        }
        
        .btn {
            padding: 12px;
            border-radius: 12px;
            border: none;
            color: white;
            font-weight: bold;
            font-size: 13px;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .btn:active {
            transform: scale(0.95);
        }
        
        .btn-primary { background: linear-gradient(90deg, #4f46e5 0%, #7c3aed 100%); }
        .btn-danger { background: linear-gradient(90deg, #dc2626 0%, #ef4444 100%); }
        .btn-success { background: linear-gradient(90deg, #16a34a 0%, #22c55e 100%); }
        .btn-warning { background: linear-gradient(90deg, #ea580c 0%, #f97316 100%); }
        
        .card {
            background: white;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        
        .card h3 {
            font-size: 18px;
            margin-bottom: 16px;
            color: #1e293b;
        }
        
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-group label {
            display: block;
            font-weight: bold;
            font-size: 14px;
            color: #475569;
            margin-bottom: 8px;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 16px;
        }
        
        .type-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }
        
        .type-option {
            padding: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .type-option.active.debt {
            border-color: #ef4444;
            background: #fee2e2;
        }
        
        .type-option.active.credit {
            border-color: #22c55e;
            background: #dcfce7;
        }
        
        .item-card {
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 12px;
            border: 2px solid;
        }
        
        .item-card.debt {
            background: linear-gradient(135deg, #fee2e2 0%, #fed7aa 100%);
            border-color: #fca5a5;
        }
        
        .item-card.credit {
            background: linear-gradient(135deg, #dcfce7 0%, #d1fae5 100%);
            border-color: #86efac;
        }
        
        .item-card.paid {
            background: #f1f5f9;
            border-color: #cbd5e1;
            opacity: 0.6;
        }
        
        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }
        
        .item-person {
            font-size: 18px;
            font-weight: bold;
        }
        
        .item-amount {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .item-actions {
            display: flex;
            gap: 8px;
        }
        
        .btn-small {
            padding: 8px 12px;
            border-radius: 8px;
            border: none;
            color: white;
            font-weight: bold;
            cursor: pointer;
            font-size: 12px;
        }
        
        .hidden { display: none; }
        
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 16px;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
        }
        
        .alert {
            background: linear-gradient(90deg, #7c3aed 0%, #4f46e5 100%);
            color: white;
            padding: 16px;
            border-radius: 16px;
            margin-bottom: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: slideDown 0.5s;
        }
        
        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 999px;
            font-size: 11px;
            font-weight: bold;
        }
        
        .badge-urgent { background: #dc2626; color: white; }
        .badge-overdue { background: #ef4444; color: white; }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        let items = [];
        let cashBalance = 0;
        let currentType = 'debt';
        let deferredPrompt;
        let currentUser = null;

        function checkLogin() {
            currentUser = localStorage.getItem('currentUser');
            if (!currentUser) {
                showLoginScreen();
            } else {
                showApp();
                loadData();
            }
        }

        function showLoginScreen() {
            document.getElementById('app').innerHTML = `
                <div style="min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px; background: linear-gradient(135deg, #1e293b 0%, #7e22ce 50%, #1e293b 100%);">
                    <div style="background: white; border-radius: 24px; padding: 32px; max-width: 400px; width: 100%; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                        <div style="text-align: center; margin-bottom: 32px;">
                            <div style="font-size: 64px; margin-bottom: 16px;">ğŸ’°</div>
                            <h1 style="font-size: 28px; color: #1e293b; margin-bottom: 8px;">BorÃ§ & Alacak Takip</h1>
                            <p style="color: #64748b; font-size: 14px;">HesabÄ±nÄ±za giriÅŸ yapÄ±n</p>
                        </div>

                        <div id="loginForm">
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; font-weight: bold; color: #475569; margin-bottom: 8px; font-size: 14px;">ğŸ‘¤ KullanÄ±cÄ± AdÄ±</label>
                                <input type="text" id="loginUsername" placeholder="KullanÄ±cÄ± adÄ±nÄ±zÄ± girin" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px;">
                            </div>
                            
                            <div style="margin-bottom: 24px;">
                                <label style="display: block; font-weight: bold; color: #475569; margin-bottom: 8px; font-size: 14px;">ğŸ”’ Åifre</label>
                                <input type="password" id="loginPassword" placeholder="Åifrenizi girin" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px;">
                            </div>

                            <button onclick="login()" style="width: 100%; padding: 14px; background: linear-gradient(90deg, #7c3aed 0%, #4f46e5 100%); color: white; border: none; border-radius: 12px; font-weight: bold; font-size: 16px; cursor: pointer; margin-bottom: 12px;">
                                ğŸš€ GiriÅŸ Yap
                            </button>

                            <button onclick="showRegisterForm()" style="width: 100%; padding: 14px; background: white; color: #7c3aed; border: 2px solid #7c3aed; border-radius: 12px; font-weight: bold; font-size: 16px; cursor: pointer;">
                                âœ¨ Yeni Hesap OluÅŸtur
                            </button>
                        </div>

                        <div id="registerForm" style="display: none;">
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; font-weight: bold; color: #475569; margin-bottom: 8px; font-size: 14px;">ğŸ‘¤ KullanÄ±cÄ± AdÄ±</label>
                                <input type="text" id="registerUsername" placeholder="KullanÄ±cÄ± adÄ± seÃ§in" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px;">
                            </div>

                            <div style="margin-bottom: 16px;">
                                <label style="display: block; font-weight: bold; color: #475569; margin-bottom: 8px; font-size: 14px;">ğŸ“§ E-posta (Opsiyonel)</label>
                                <input type="email" id="registerEmail" placeholder="ornek@email.com" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px;">
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; font-weight: bold; color: #475569; margin-bottom: 8px; font-size: 14px;">ğŸ”’ Åifre</label>
                                <input type="password" id="registerPassword" placeholder="GÃ¼Ã§lÃ¼ bir ÅŸifre seÃ§in" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px;">
                            </div>

                            <div style="margin-bottom: 24px;">
                                <label style="display: block; font-weight: bold; color: #475569; margin-bottom: 8px; font-size: 14px;">ğŸ”’ Åifre Tekrar</label>
                                <input type="password" id="registerPasswordConfirm" placeholder="Åifrenizi tekrar girin" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 16px;">
                            </div>

                            <button onclick="register()" style="width: 100%; padding: 14px; background: linear-gradient(90deg, #16a34a 0%, #22c55e 100%); color: white; border: none; border-radius: 12px; font-weight: bold; font-size: 16px; cursor: pointer; margin-bottom: 12px;">
                                âœ… Hesap OluÅŸtur
                            </button>

                            <button onclick="showLoginForm()" style="width: 100%; padding: 14px; background: white; color: #64748b; border: 2px solid #e2e8f0; border-radius: 12px; font-weight: bold; font-size: 16px; cursor: pointer;">
                                â† GiriÅŸ SayfasÄ±na DÃ¶n
                            </button>
                        </div>

                        <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid #e2e8f0; text-align: center;">
                            <p style="font-size: 12px; color: #94a3b8;">
                                ğŸ”’ Verileriniz gÃ¼venli ÅŸekilde cihazÄ±nÄ±zda saklanÄ±r
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        function showRegisterForm() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
        }

        function showLoginForm() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('registerForm').style.display = 'none';
        }

        function register() {
            const username = document.getElementById('registerUsername').value.trim();
            const email = document.getElementById('registerEmail').value.trim();
            const password = document.getElementById('registerPassword').value;
            const passwordConfirm = document.getElementById('registerPasswordConfirm').value;

            if (!username) {
                alert('âŒ KullanÄ±cÄ± adÄ± gerekli!');
                return;
            }

            if (username.length < 3) {
                alert('âŒ KullanÄ±cÄ± adÄ± en az 3 karakter olmalÄ±!');
                return;
            }

            if (!password) {
                alert('âŒ Åifre gerekli!');
                return;
            }

            if (password.length < 4) {
                alert('âŒ Åifre en az 4 karakter olmalÄ±!');
                return;
            }

            if (password !== passwordConfirm) {
                alert('âŒ Åifreler eÅŸleÅŸmiyor!');
                return;
            }

            const users = JSON.parse(localStorage.getItem('users') || '{}');
            if (users[username]) {
                alert('âŒ Bu kullanÄ±cÄ± adÄ± zaten kullanÄ±lÄ±yor!');
                return;
            }

            users[username] = {
                password: btoa(password),
                email: email,
                createdAt: new Date().toISOString()
            };

            localStorage.setItem('users', JSON.stringify(users));
            alert('ğŸ‰ HesabÄ±nÄ±z oluÅŸturuldu!\n\nÅimdi giriÅŸ yapabilirsiniz.');
            showLoginForm();
        }

        function login() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;

            if (!username || !password) {
                alert('âŒ KullanÄ±cÄ± adÄ± ve ÅŸifre gerekli!');
                return;
            }

            const users = JSON.parse(localStorage.getItem('users') || '{}');
            const user = users[username];

            if (!user) {
                alert('âŒ KullanÄ±cÄ± bulunamadÄ±!');
                return;
            }

            if (atob(user.password) !== password) {
                alert('âŒ Åifre yanlÄ±ÅŸ!');
                return;
            }

            localStorage.setItem('currentUser', username);
            currentUser = username;
            location.reload();
        }

        function logout() {
            if (confirm('Ã‡Ä±kÄ±ÅŸ yapmak istediÄŸinizden emin misiniz?')) {
                localStorage.removeItem('currentUser');
                location.reload();
            }
        }

        function showApp() {
            document.getElementById('app').innerHTML = `
                <div class="header">
                    <div class="header-title">
                        <span style="font-size: 28px;">ğŸ’°</span>
                        <h1>BorÃ§ & Alacak</h1>
                        <div style="margin-left: auto; display: flex; align-items: center; gap: 8px;">
                            <span style="color: white; font-size: 14px; background: rgba(255,255,255,0.2); padding: 6px 12px; border-radius: 8px;">ğŸ‘¤ ${currentUser}</span>
                            <button onclick="logout()" style="background: rgba(255,255,255,0.2); border: none; color: white; padding: 6px 12px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 12px;">ğŸšª Ã‡Ä±kÄ±ÅŸ</button>
                        </div>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card kasa">
                            <div class="stat-label">ğŸ’° Kasa</div>
                            <div class="stat-value" id="kasaValue">0,00</div>
                        </div>
                        <div class="stat-card borc">
                            <div class="stat-label">BorÃ§</div>
                            <div class="stat-value" id="borcValue">0,00</div>
                        </div>
                        <div class="stat-card alacak">
                            <div class="stat-label">Alacak</div>
                            <div class="stat-value" id="alacakValue">0,00</div>
                        </div>
                        <div class="stat-card net">
                            <div class="stat-label">ğŸ’ Net</div>
                            <div class="stat-value" id="netValue">0,00</div>
                        </div>
                    </div>
                </div>

                <div class="container">
                    <div class="button-grid">
                        <button class="btn btn-primary" onclick="toggleForm()">â• KayÄ±t</button>
                        <button class="btn btn-danger" onclick="togglePeople()">ğŸ‘¥ KiÅŸiler</button>
                        <button class="btn btn-warning" onclick="toggleCash()">ğŸ’° Kasa</button>
                        <button class="btn btn-success" onclick="toggleSettings()">âš™ï¸ Ayarlar</button>
                    </div>

                    <div id="formCard" class="card hidden">
                        <h3>â• Yeni KayÄ±t</h3>
                        <div class="type-selector">
                            <div class="type-option active debt" onclick="selectType('debt')">
                                <div style="font-size: 24px; margin-bottom: 8px;">ğŸ“‰</div>
                                <div style="font-weight: bold; color: #dc2626;">BorÃ§</div>
                                <div style="font-size: 11px; color: #64748b;">Ã–deyeceÄŸim</div>
                            </div>
                            <div class="type-option" onclick="selectType('credit')">
                                <div style="font-size: 24px; margin-bottom: 8px;">ğŸ“ˆ</div>
                                <div style="font-weight: bold; color: #16a34a;">Alacak</div>
                                <div style="font-size: 11px; color: #64748b;">Tahsil edeceÄŸim</div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>ğŸ‘¤ KiÅŸi/Kurum</label>
                            <input type="text" id="personInput" placeholder="AdÄ± girin">
                        </div>
                        
                        <div class="form-group">
                            <label>ğŸ’° Tutar</label>
                            <input type="number" id="amountInput" step="0.01" placeholder="0,00">
                        </div>
                        
                        <div class="form-group">
                            <label>ğŸ“ AÃ§Ä±klama</label>
                            <input type="text" id="descInput" placeholder="Ã–deme nedeni...">
                        </div>
                        
                        <div class="form-group">
                            <label>ğŸ“… Vade Tarihi</label>
                            <input type="date" id="dateInput">
                        </div>
                        
                        <button class="btn btn-primary" style="width: 100%;" onclick="saveItem()">ğŸ’¾ Kaydet</button>
                    </div>

                    <div id="cashCard" class="card hidden">
                        <h3>ğŸ’° Kasa YÃ¶netimi</h3>
                        <div style="background: linear-gradient(90deg, #fef3c7 0%, #fed7aa 100%); border-radius: 12px; padding: 16px; margin-bottom: 16px; border: 2px solid #fbbf24;">
                            <div style="font-size: 12px; color: #78350f; margin-bottom: 4px;">Mevcut Bakiye</div>
                            <div style="font-size: 32px; font-weight: bold;" id="cashBalance">0,00 â‚º</div>
                        </div>
                        
                        <div class="form-group">
                            <label>ğŸ’µ Tutar</label>
                            <input type="number" id="cashAmountInput" step="0.01" placeholder="Para ekle (+) veya Ã§Ä±kar (-)">
                        </div>
                        
                        <button class="btn btn-warning" style="width: 100%;" onclick="updateCash()">ğŸ’° Ä°ÅŸlemi Kaydet</button>
                    </div>

                    <div id="settingsCard" class="card hidden">
                        <h3>âš™ï¸ Ayarlar</h3>
                        
                        <div style="background: linear-gradient(90deg, #f0f9ff 0%, #e0f2fe 100%); border-radius: 12px; padding: 16px; margin-bottom: 16px; border: 2px solid #38bdf8;">
                            <div style="font-size: 14px; font-weight: bold; color: #0369a1; margin-bottom: 8px;">ğŸ¤– OpenAI API YapÄ±landÄ±rmasÄ±</div>
                            <div style="font-size: 12px; color: #0c4a6e;">ChatGPT/GPT-3 Ã¶zelliklerini kullanmak iÃ§in API anahtarÄ±nÄ±zÄ± girin.</div>
                        </div>
                        
                        <div class="form-group">
                            <label>ğŸ”‘ OpenAI API Key</label>
                            <input type="password" id="apiKeyInput" placeholder="sk-...">
                            <div style="font-size: 11px; color: #64748b; margin-top: 4px;">API anahtarÄ±nÄ±z gÃ¼venli ÅŸekilde cihazÄ±nÄ±zda saklanÄ±r</div>
                        </div>
                        
                        <div style="display: flex; gap: 8px;">
                            <button class="btn btn-primary" style="flex: 1;" onclick="saveApiKey()">ğŸ’¾ Kaydet</button>
                            <button class="btn btn-danger" style="flex: 1;" onclick="clearApiKey()">ğŸ—‘ï¸ Temizle</button>
                        </div>
                        
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 2px solid #e2e8f0;">
                            <div style="font-size: 12px; color: #64748b; margin-bottom: 8px;">
                                <strong>API AnahtarÄ± NasÄ±l KullanÄ±lÄ±r?</strong>
                            </div>
                            <div style="font-size: 11px; color: #94a3b8; line-height: 1.6; margin-bottom: 12px;">
                                API anahtarÄ±nÄ±zÄ± kaydettikten sonra, gelecekte eklenecek ChatGPT Ã¶zellikleri iÃ§in hazÄ±r olacaksÄ±nÄ±z:<br><br>
                                â€¢ ğŸ¤– <strong>AkÄ±llÄ± Ã–neriler</strong>: BorÃ§ ve alacak yÃ¶netimi iÃ§in AI tavsiyeleri<br>
                                â€¢ ğŸ“Š <strong>Ã–deme PlanlarÄ±</strong>: KiÅŸiselleÅŸtirilmiÅŸ Ã¶deme stratejileri<br>
                                â€¢ ğŸ’¬ <strong>Sohbet AsistanÄ±</strong>: Finansal sorularÄ±nÄ±z iÃ§in yapay zeka desteÄŸi<br>
                                â€¢ ğŸ“ <strong>AkÄ±llÄ± Notlar</strong>: Otomatik aÃ§Ä±klama ve kategorizasyon<br><br>
                                <em>Not: Bu Ã¶zellikler geliÅŸtirilme aÅŸamasÄ±ndadÄ±r. API anahtarÄ±nÄ±z kaydedildi ve hazÄ±r olduÄŸunda otomatik olarak kullanÄ±lacaktÄ±r.</em>
                            </div>
                        </div>
                        
                        <div style="margin-top: 16px; padding-top: 16px; border-top: 2px solid #e2e8f0;">
                            <div style="font-size: 12px; color: #64748b; margin-bottom: 8px;">
                                <strong>API AnahtarÄ± Nereden AlÄ±nÄ±r?</strong>
                            </div>
                            <div style="font-size: 11px; color: #94a3b8; line-height: 1.6;">
                                1. <a href="https://platform.openai.com" target="_blank" style="color: #7c3aed;">platform.openai.com</a> adresine gidin<br>
                                2. HesabÄ±nÄ±za giriÅŸ yapÄ±n<br>
                                3. API Keys bÃ¶lÃ¼mÃ¼ne gidin<br>
                                4. "Create new secret key" butonuna tÄ±klayÄ±n
                            </div>
                        </div>
                    </div>

                    <div id="itemsList"></div>
                </div>

                <div class="footer">
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-primary" style="flex: 1;" onclick="requestNotifications()">ğŸ”” Bildirimler</button>
                        <button class="btn btn-success" style="flex: 1;" onclick="showInstallPrompt()">ğŸ“± YÃ¼kle</button>
                    </div>
                </div>
            `;
        }

        function loadData() {
            const userKey = getUserKey();
            const savedItems = localStorage.getItem(userKey + '_items');
            const savedCash = localStorage.getItem(userKey + '_cash');
            
            if (savedItems) items = JSON.parse(savedItems);
            if (savedCash) cashBalance = parseFloat(savedCash);
            
            updateUI();
        }

        function saveData() {
            const userKey = getUserKey();
            localStorage.setItem(userKey + '_items', JSON.stringify(items));
            localStorage.setItem(userKey + '_cash', cashBalance.toString());
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('tr-TR', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }

        function getUserKey() {
            return 'user_' + currentUser;
        }

        function toggleForm() {
            const form = document.getElementById('formCard');
            form.classList.toggle('hidden');
            document.getElementById('cashCard').classList.add('hidden');
            document.getElementById('settingsCard').classList.add('hidden');
        }

        function toggleCash() {
            const cash = document.getElementById('cashCard');
            cash.classList.toggle('hidden');
            document.getElementById('formCard').classList.add('hidden');
            document.getElementById('settingsCard').classList.add('hidden');
        }

        function toggleSettings() {
            const settings = document.getElementById('settingsCard');
            settings.classList.toggle('hidden');
            document.getElementById('formCard').classList.add('hidden');
            document.getElementById('cashCard').classList.add('hidden');
            
            // Load current API key if exists
            if (!settings.classList.contains('hidden')) {
                const apiKey = localStorage.getItem(getUserKey() + '_apiKey');
                if (apiKey) {
                    document.getElementById('apiKeyInput').value = apiKey;
                } else {
                    document.getElementById('apiKeyInput').value = '';
                }
            }
        }

        function saveApiKey() {
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            
            if (!apiKey) {
                alert('âŒ API anahtarÄ± gerekli!');
                return;
            }
            
            if (!apiKey.startsWith('sk-')) {
                if (!confirm('âš ï¸ UyarÄ±: OpenAI API anahtarlarÄ± genellikle "sk-" ile baÅŸlar. Yine de devam etmek istiyor musunuz?')) {
                    return;
                }
            }
            
            localStorage.setItem(getUserKey() + '_apiKey', apiKey);
            
            alert('âœ… API anahtarÄ± kaydedildi!\n\nğŸ¤– ChatGPT Ã¶zellikleri artÄ±k kullanÄ±labilir.');
        }

        function clearApiKey() {
            if (!confirm('API anahtarÄ±nÄ± silmek istediÄŸinizden emin misiniz?')) return;
            
            localStorage.removeItem(getUserKey() + '_apiKey');
            document.getElementById('apiKeyInput').value = '';
            
            alert('âœ… API anahtarÄ± silindi!');
        }

        function togglePeople() {
            alert('ğŸ‘¥ KiÅŸiler Ã¶zelliÄŸi yakÄ±nda eklenecek!');
        }

        function selectType(type) {
            currentType = type;
            document.querySelectorAll('.type-option').forEach(el => el.classList.remove('active'));
            event.target.closest('.type-option').classList.add('active', type);
        }

        function saveItem() {
            const person = document.getElementById('personInput').value;
            const amount = parseFloat(document.getElementById('amountInput').value);
            const description = document.getElementById('descInput').value;
            const dueDate = document.getElementById('dateInput').value;

            if (!person || !amount) {
                alert('âŒ KiÅŸi ve tutar zorunludur!');
                return;
            }

            items.push({
                id: Date.now(),
                type: currentType,
                person,
                amount,
                description,
                dueDate,
                paid: false
            });

            saveData();
            updateUI();
            
            document.getElementById('personInput').value = '';
            document.getElementById('amountInput').value = '';
            document.getElementById('descInput').value = '';
            document.getElementById('dateInput').value = '';
            toggleForm();
            
            alert('âœ… KayÄ±t eklendi!');
        }

        function updateCash() {
            const amount = parseFloat(document.getElementById('cashAmountInput').value);
            if (!amount) {
                alert('âŒ Tutar girin!');
                return;
            }
            
            cashBalance += amount;
            saveData();
            updateUI();
            document.getElementById('cashAmountInput').value = '';
            alert(`âœ… Kasa gÃ¼ncellendi!\n\nYeni bakiye: ${formatCurrency(cashBalance)} â‚º`);
        }

        function togglePaid(id) {
            const item = items.find(i => i.id === id);
            if (!item) return;
            
            const amount = item.amount;
            item.paid = !item.paid;
	
	    if (item.paid) {
                if (item.type === 'debt') {
                    cashBalance -= amount;
                } else {
                    cashBalance += amount;
                }
            } else {
                if (item.type === 'debt') {
                    cashBalance += amount;
                } else {
                    cashBalance -= amount;
                }
            }
            
            saveData();
            updateUI();
        }

        function deleteItem(id) {
            if (!confirm('Silmek istediÄŸinizden emin misiniz?')) return;
            
            items = items.filter(i => i.id !== id);
            saveData();
            updateUI();
            alert('âœ… KayÄ±t silindi!');
        }

        function updateUI() {
            const totals = items.reduce((acc, item) => {
                if (!item.paid) {
                    if (item.type === 'debt') {
                        acc.debt += item.amount;
                    } else {
                        acc.credit += item.amount;
                    }
                }
                return acc;
            }, { debt: 0, credit: 0 });

            document.getElementById('kasaValue').textContent = formatCurrency(cashBalance);
            document.getElementById('borcValue').textContent = formatCurrency(totals.debt);
            document.getElementById('alacakValue').textContent = formatCurrency(totals.credit);
            
            const netValue = cashBalance + totals.credit - totals.debt;
            document.getElementById('netValue').textContent = formatCurrency(netValue);
            document.getElementById('netValue').style.color = netValue >= 0 ? '#dcfce7' : '#fecaca';
            
            document.getElementById('cashBalance').textContent = formatCurrency(cashBalance) + ' â‚º';
            document.getElementById('cashBalance').style.color = cashBalance >= 0 ? '#15803d' : '#dc2626';

            const list = document.getElementById('itemsList');
            list.innerHTML = items.map(item => `
                <div class="item-card ${item.type} ${item.paid ? 'paid' : ''}">
                    <div class="item-header">
                        <div>
                            <div class="item-person" style="color: ${item.paid ? '#64748b' : item.type === 'debt' ? '#dc2626' : '#16a34a'}">
                                ${item.person}
                            </div>
                            ${item.dueDate ? `<div style="font-size: 12px; color: #64748b; margin-top: 4px;">ğŸ“… ${new Date(item.dueDate).toLocaleDateString('tr-TR')}</div>` : ''}
                        </div>
                        ${!item.paid && getDaysUntilDue(item.dueDate) < 0 ? '<span class="badge badge-overdue">GEÃ‡TÄ°</span>' : ''}
                        ${!item.paid && getDaysUntilDue(item.dueDate) >= 0 && getDaysUntilDue(item.dueDate) <= 3 ? '<span class="badge badge-urgent">ACÄ°L</span>' : ''}
                    </div>
                    <div class="item-amount" style="color: ${item.paid ? '#64748b' : item.type === 'debt' ? '#dc2626' : '#16a34a'}">
                        ${item.type === 'debt' ? '-' : '+'}${formatCurrency(item.amount)} â‚º
                    </div>
                    ${item.description ? `<div style="font-size: 14px; color: #64748b; margin-bottom: 12px;">${item.description}</div>` : ''}
                    <div class="item-actions">
                        <button class="btn-small" style="flex: 1; background: ${item.paid ? '#94a3b8' : '#7c3aed'};" onclick="togglePaid(${item.id})">
                            ${item.paid ? 'âŒ Ã–denmedi' : 'âœ… Ã–dendi'}
                        </button>
                        <button class="btn-small" style="background: #dc2626;" onclick="deleteItem(${item.id})">ğŸ—‘ï¸</button>
                    </div>
                </div>
            `).join('');
        }

        function getDaysUntilDue(dueDate) {
            if (!dueDate) return 999;
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const due = new Date(dueDate);
            due.setHours(0, 0, 0, 0);
            return Math.ceil((due - today) / (1000 * 60 * 60 * 24));
        }

        function requestNotifications() {
            if ('Notification' in window) {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        alert('âœ… Bildirimler aÃ§Ä±ldÄ±!');
                    }
                });
            } else {
                alert('âŒ TarayÄ±cÄ±nÄ±z bildirimleri desteklemiyor.');
            }
        }

        function showInstallPrompt() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then(choice => {
                    if (choice.outcome === 'accepted') {
                        alert('ğŸ‰ Uygulama yÃ¼klendi!');
                    }
                    deferredPrompt = null;
                });
            } else {
                alert('ğŸ“± Uygulama YÃ¼kleme:\n\n1. Chrome menÃ¼ (â‹®)\n2. "Ana ekrana ekle"\n3. "Ekle" butonuna bas\n\nveya\n\niOS Safari:\n1. PaylaÅŸ (ğŸ“¤)\n2. "Ana Ekrana Ekle"');
            }
        }

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
        });

        window.addEventListener('load', checkLogin);
    </script>
</body>
</html>
```

---
